# ESG-data-cleanup
A data cleaning project using an ESG risk score dataset from Kaggle user Pritish Dugar. The initial data was imported into PostgreSQL, with all values imported as text to enable the many different types of values to be imported. The comprehensive dataset provides a clear view into the risk profiles of various companies in the S&P 500. However, the dataset also contains several issues with data formats, representation of NULL values, and columns that do not meaningfully contribute to the analysis. As such, the dataset needed to be cleaned up in PostgreSQL to be analysed properly. The detailed steps for the cleanup are in the SQL file attached to this repository, along with the SQL queries used to clean up the dataset. I have also attached the initial dataset, as well as the cleaned one. 

The first step of the cleanup included creating a temporary (TEMP) table to do the first round of cleanups before the data is placed into a regular table in the next step. In the new temp table, I have selected only the columns that would be useful in analysis, leaving out the columns which would not (columns like Address and Description are not helpful when it comes to querying the dataset for summary statistics, so they have been left out. The columns have been renamed, and columns containing useful data without null values have been standardized to numeric values. 

The second step included more cleaning of the data. The "employees" column contained numbers with ',' in them, thus not allowing the data to be imported as numerical values. The ',' are replaced with blank spaces, then the entire column is reformatted to numeric data. The 'controversy_level' column had long value names, so I shortened them to only show the level itself. The column 'controversy_score' contained some 'N/A' values instead of NULL. This also prevented the column from being imported as numeric values. Thus, the 'N/A' values have been replaced with NULL using the CASE WHEN function, and then the column can be reformatted to numeric. The column 'risk_percentile' had values like "3rd percentile" or "30th percentile". To simplify querying, I removed the letters behind the numbers, then reformatted the column to numeric values for further querying. 

Finally, the temporary table was moved into a regular table using the SELECT INTO function. The dataset is now clean and ready for querying. 
